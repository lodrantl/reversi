language: python

matrix:
  include:
#    - os: linux
#      python: 3.5
#      dist: trusty
#      sudo: required
    - os: osx
      language: generic
      env: PYTHON=3.5.3

install:
  # Print system info
  - uname -a

  # Update brew packages on macOS
  - if [[ $TRAVIS_OS_NAME == "osx" ]]; then brew update; fi

  # Install dependencies per system
  - chmod +x ci/linux/*
  - chmod +x ci/mac/*

  - if [[ $TRAVIS_OS_NAME == "osx" ]]; then source ./ci/mac/install.sh; fi
  - if [[ $TRAVIS_OS_NAME == "linux" ]]; then source ./ci/linux/install.sh; fi

script:
  - python -m pytest
  # Build executables
  - if [[ $TRAVIS_OS_NAME == "osx" ]]; then ./ci/mac/build.sh; fi
  - if [[ $TRAVIS_OS_NAME == "linux" ]]; then ./ci/linux/build.sh; fi

deploy:
  provider: s3
  access_key_id: AKIAV75KFALGCVTXWUQ
  secret_access_key:
    secure: sNwBh7K3//1XpA3U+9hGvKbRNLRsYOBSQhjjPD30rO1LV1jzaCaEiiEfKRwKsU62shNeBOTMlnchSBZ8Wctah+S091AXamAdUib/wfPLic7VQFNhuEUv1UeU3tzEGJ1D4tRzA9wgSIdTvyL+w7mvm62f3g5juNTovNfZot32+WNFqcIOJvLBBZxkltqmRH4wKn2Vky2ZdiV8TzwypeXMywaEFoaO9iyjISN3QWU5wb51/Q9cAjUToEhWirKwIynz9ESn26J4W3YMdEf000V5u78Kmov7AbGNGBMQbBfDilswGrzMqlQ/hF74JfQUsa1vcZwerfHI5zZsYRwN7byZ68JWGvWHZtz6dBY1IBikx9aBpchsO4kpcMg5ug07morcH9Vnc4F2t+tE0/hJZeT25Hbk0vfVaeTAgXXceqiNhSmEBVcZ9SWLwaLQ/WrxH3iq1yBcfdrmjbluj3dAigxWC+S3NRPi6g7zIH5hPoee7MUFHCCnRREnX4rmYrG9rCKAS9W0jSv9GAntGNmpYL3dqmg6tS5hndKjwFGHxZz2EqklwTpveD7L4eHC5mUnmTO/mHhPlz57tG7ldx9cOgjZYRBHgttWJEefk8I6Y1ciIeAhf2XhePYzRLe2hvmYLNG9eYLzBdhH386oUsYGT2aK/rQENlAu6nobFM/Fxj8k3VA=
  bucket: reversi-nightlies
  local-dir: dist/final/
  skip_cleanup: true
  acl: public_read
  on:
    repo: lodrantl/reversi
    branch: ci-build
